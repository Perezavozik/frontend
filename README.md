
# Frontend — Информационный портал ФЛНКА  
## Техническое описание, архитектура, внутренние модули

## Технологический стек

- Next.js 14 (App Router) — SSR/SSG, динамические маршруты, server actions
- React 18 — компонентный UI слой
- TypeScript — строгая типизация
- next-intl (i18n) — интернационализация UI
- Redux Toolkit — глобальное состояние (locale)
- Axios — API SDK/HTTP клиент
- html-react-parser — безопасный парсинг HTML статей
- yet-another-react-lightbox — модальная галерея
- IntersectionObserver API — scroll-spy реализация
- CSS Modules — модульные стили
- ESLint + Prettier — единый code style

---

# Архитектурная структура
Все реализовано по технологии FSD максимальное старание следования кодексу

src/
├── app/ # маршруты Next.js
├── features/ # функциональные блоки
│ ├── htmlBlock/
│ ├── pageSections/
│ ├── pageTitle/
│ └── separator/
├── shared/
│ ├── api/ # API SDK
│ │ ├── base.ts
│ │ └── endpoints/
│ ├── context/
│ │ ├── GlobalLightboxContext.tsx
│ │ └── RightNavContext.tsx
│ ├── hooks/
│ │ └── useScrollSpy.ts
│ ├── redux/
│ │ ├── store.ts
│ │ └── localeSlice.ts
│ ├── i18n/ # next-intl configs
│ └── IntlProviderWrapper.tsx
├── styles/
└── widgets/


---

# Детали реализации

## 1. API-клиент уровня SDK

Файл `base.ts`:

- задаёт базовый URL
- автоматически добавляет:
  - CSRF cookie → header
  - `Accept-Language`
- логирует ошибки
- формирует экземпляр Axios со строгими типами ответов

Каждый endpoint декомпозирован в отдельный модуль.

## 2. Парсинг HTML-контента

ФЛНКА использует большой объём статей:

- исторические очерки
- отчёты конгрессов
- новостные публикации
- аналитические материалы

HTML приходит с backend → превращается в структуру React элементов.

Особые правила:

- `<img>` → `<Image />` (Next.js оптимизация)
- `<h2>`, `<h3>` → привязка к ScrollSpy (для быстрой навигации между разделами, автосоставление меню навигации)
- `<a>` → нормализация относительных ссылок

## 3. Динамическое правое меню (pageSections)

Реализация включает:

- парсер, который проходит DOM HTML блока,
- извлекает заголовки,
- формирует структуру вида:

[
{ id: 'intro', label: 'Введение' },
{ id: 'history-1', label: 'История. Часть I' },
...
]

- наблюдает за секциями через IntersectionObserver

Это критически важно для длинных материалов ФЛНКА, тк ежегодные отчеты могут составлять десятки страниц а4, скрипт автоматически составляет навигацию по пунктам

## 4. Глобальная галерея

Любое фото, у которого есть:

<img data-gallery="report-2025" src="..."> ```

— автоматически попадает в Lightbox.

## Реализованные фронтенд-страницы

Главная
Новости (список + детальная)
Новости разделены на разные (каждая лист + детальная):
  Народные премии
  Мероприятия (проведение + запись на актуальное мероприятие)
  Новости общества
  Родной язык
  История
  Культура
  Медиатека
Проекты ФЛНКА
Отчёты
Галереи и медиаматериалы
О ФЛНКА
Контакты
Telegram-лента (парсер с реального телеграм канала, текст + фото, авто сжимание фото на беке)
Различные голосования (лист + детальная)
Поиск по всем страницам, видам контента

## Сложности и решения

## Реализация поиска по всему контенту
Реализованы таблицы соответствия страниц на беке и фронте, чтобы можно было прямо переходить на результаты поиска

## SSR + i18n сочетание

next-intl полностью совместим с SSR, но требует отдельного wrapper’а → IntlProviderWrapper.

## Оптимизация загрузки изображений

Используется замена <img> → Next.js <Image /> с предобработкой пропорций.

## Стабильность при больших объёмах контента

Разделы могут включать по 80+ изображений и большие HTML-блоки.
Поэтому предусмотрен ленивый рендеринг.

## Готовность к продакшену

Next.js build → статические страницы + SSR

Возможность деплоя на Vercel / Docker

Разделение чанков

Использование RSC (React Server Components) там, где возможно
